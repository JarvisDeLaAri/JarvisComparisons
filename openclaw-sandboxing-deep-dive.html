<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OpenClaw Security Architecture Deep Dive ‚Äî Gateway vs Main Agent vs Sub-Agent</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { background: #0a0e1a; color: #c8ccd8; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; padding: 24px; line-height: 1.6; }
.container { max-width: 1200px; margin: 0 auto; }
h1 { color: #fff; font-size: 2em; text-align: center; margin-bottom: 8px; }
.subtitle { color: #8b92a8; text-align: center; margin-bottom: 32px; font-size: 1.1em; }
h2 { color: #e8ecf4; font-size: 1.5em; margin: 40px 0 20px; padding-bottom: 8px; border-bottom: 2px solid #1e2640; }
h3 { color: #d0d5e2; font-size: 1.15em; margin: 24px 0 12px; }

/* Three-column comparison */
.tri-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 16px; margin: 20px 0; }
.card { background: #111827; border-radius: 12px; padding: 20px; border: 2px solid #1e2640; }
.card-gateway { border-color: #ef4444; }
.card-main { border-color: #f59e0b; }
.card-sub { border-color: #10b981; }
.card-title { font-size: 1.2em; font-weight: 700; margin-bottom: 4px; }
.card-gateway .card-title { color: #ef4444; }
.card-main .card-title { color: #f59e0b; }
.card-sub .card-title { color: #10b981; }
.card-badge { display: inline-block; padding: 2px 10px; border-radius: 20px; font-size: 0.75em; font-weight: 600; margin-bottom: 12px; }
.badge-red { background: #3b1219; color: #fca5a5; }
.badge-amber { background: #3b2e10; color: #fcd34d; }
.badge-green { background: #0d3b2e; color: #6ee7b7; }
.card-desc { color: #8b92a8; font-size: 0.9em; margin-bottom: 16px; }

.spec-list { list-style: none; }
.spec-list li { padding: 6px 0; border-bottom: 1px solid #1a2035; font-size: 0.92em; display: flex; justify-content: space-between; }
.spec-list li:last-child { border-bottom: none; }
.spec-label { color: #8b92a8; }
.spec-value { color: #e8ecf4; font-weight: 600; text-align: right; }

.tag { display: inline-block; padding: 1px 8px; border-radius: 10px; font-size: 0.8em; font-weight: 600; }
.tag-red { background: #3b1219; color: #fca5a5; }
.tag-amber { background: #3b2e10; color: #fcd34d; }
.tag-green { background: #0d3b2e; color: #6ee7b7; }
.tag-blue { background: #102a4a; color: #93c5fd; }
.tag-gray { background: #1e2640; color: #8b92a8; }

/* Pros/Cons */
.pros-cons { margin-top: 16px; }
.pro, .con, .neutral { padding: 4px 0; font-size: 0.88em; }
.pro::before { content: "‚úÖ "; }
.con::before { content: "‚ùå "; }
.neutral::before { content: "üü° "; }

/* Syscall table */
.syscall-section { margin: 24px 0; }
.syscall-grid { display: grid; grid-template-columns: 1fr; gap: 2px; }
.syscall-header { display: grid; grid-template-columns: 180px 1fr 100px 100px; gap: 8px; padding: 10px 12px; background: #1a2240; border-radius: 8px 8px 0 0; font-weight: 700; font-size: 0.85em; color: #e8ecf4; }
.syscall-row { display: grid; grid-template-columns: 180px 1fr 100px 100px; gap: 8px; padding: 8px 12px; background: #111827; font-size: 0.82em; border-bottom: 1px solid #0a0e1a; }
.syscall-row:nth-child(odd) { background: #0f1524; }
.syscall-name { color: #93c5fd; font-family: monospace; font-weight: 600; }
.syscall-desc { color: #8b92a8; }
.syscall-impact { text-align: center; }

/* How it works section */
.flow-boxes { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin: 20px 0; }
.flow-box { background: #111827; border-radius: 10px; padding: 16px; border-left: 4px solid #3b82f6; }
.flow-box-title { color: #93c5fd; font-weight: 700; margin-bottom: 6px; }
.flow-box-text { color: #8b92a8; font-size: 0.9em; }

/* Community section */
.community-card { background: #111827; border-radius: 12px; padding: 20px; border: 2px solid #1e2640; margin: 12px 0; }
.community-source { color: #8b92a8; font-size: 0.8em; margin-bottom: 8px; }
.community-quote { color: #e8ecf4; font-style: italic; margin-bottom: 8px; }
.community-take { color: #93c5fd; font-size: 0.9em; }

/* Verdict */
.verdict { background: linear-gradient(135deg, #111827 0%, #1a1f35 100%); border: 2px solid #3b82f6; border-radius: 12px; padding: 24px; margin: 32px 0; }
.verdict-title { color: #93c5fd; font-size: 1.3em; font-weight: 700; margin-bottom: 12px; }
.verdict-text { color: #c8ccd8; font-size: 1em; line-height: 1.7; }
.verdict-text strong { color: #fff; }

/* Responsive */
@media (max-width: 900px) {
  .tri-grid { grid-template-columns: 1fr; }
  .flow-boxes { grid-template-columns: 1fr; }
  .syscall-header, .syscall-row { grid-template-columns: 120px 1fr 70px 70px; font-size: 0.75em; }
}
</style>
</head>
<body>
<div class="container">

<h1>ü¶û OpenClaw Security Architecture Deep Dive</h1>
<p class="subtitle">Gateway vs Main Agent vs Sub-Agent ‚Äî Comprehensive Syscall Security Reference</p>

<!-- SECTION 1: Three-Way Comparison -->
<h2>1. The Three Layers of OpenClaw</h2>

<div class="tri-grid">
  <!-- Gateway -->
  <div class="card card-gateway">
    <div class="card-title">üî¥ Gateway Process</div>
    <span class="card-badge badge-red">THE BRAIN</span>
    <div class="card-desc">The Node.js daemon that runs everything. Manages sessions, channels, tools, cron, and all communication.</div>
    <ul class="spec-list">
      <li><span class="spec-label">Process</span><span class="spec-value"><code>openclaw-gateway</code></span></li>
      <li><span class="spec-label">Runs as</span><span class="spec-value"><span class="tag tag-red">root</span></span></li>
      <li><span class="spec-label">Sandboxed?</span><span class="spec-value"><span class="tag tag-red">Never</span></span></li>
      <li><span class="spec-label">Filesystem</span><span class="spec-value"><span class="tag tag-red">Full access</span></span></li>
      <li><span class="spec-label">Network</span><span class="spec-value"><span class="tag tag-red">Full access</span></span></li>
      <li><span class="spec-label">Shell exec</span><span class="spec-value"><span class="tag tag-red">Unrestricted</span></span></li>
      <li><span class="spec-label">Capabilities</span><span class="spec-value"><span class="tag tag-red">ALL</span></span></li>
      <li><span class="spec-label">Seccomp</span><span class="spec-value"><span class="tag tag-gray">None</span></span></li>
      <li><span class="spec-label">Docker isolation</span><span class="spec-value"><span class="tag tag-gray">N/A (bare metal)</span></span></li>
    </ul>
    <div class="pros-cons">
      <div class="pro">Maximum power ‚Äî can do anything on the machine</div>
      <div class="pro">No restrictions on tools, exec, file access</div>
      <div class="pro">Can manage Docker containers, services, users</div>
      <div class="con">If compromised, attacker owns everything</div>
      <div class="con">No syscall filtering ‚Äî full kernel access</div>
    </div>
  </div>

  <!-- Main Agent -->
  <div class="card card-main">
    <div class="card-title">üü° Main Agent Session</div>
    <span class="card-badge badge-amber">YOUR CHAT</span>
    <div class="card-desc">The session you talk to directly. Runs inside the gateway process. Tools execute on the host by default.</div>
    <ul class="spec-list">
      <li><span class="spec-label">Process</span><span class="spec-value">Part of gateway</span></li>
      <li><span class="spec-label">Runs as</span><span class="spec-value"><span class="tag tag-red">root</span> (inherits gateway)</span></li>
      <li><span class="spec-label">Sandboxed?</span><span class="spec-value"><span class="tag tag-amber">Configurable</span></span></li>
      <li><span class="spec-label">Default sandbox mode</span><span class="spec-value"><span class="tag tag-gray">off</span></span></li>
      <li><span class="spec-label">Filesystem</span><span class="spec-value"><span class="tag tag-red">Full (when off)</span></span></li>
      <li><span class="spec-label">Network</span><span class="spec-value"><span class="tag tag-red">Full (when off)</span></span></li>
      <li><span class="spec-label">All tools</span><span class="spec-value"><span class="tag tag-amber">Policy-gated</span></span></li>
      <li><span class="spec-label">Elevated exec</span><span class="spec-value"><span class="tag tag-amber">Always on host</span></span></li>
      <li><span class="spec-label">Can spawn sub-agents</span><span class="spec-value"><span class="tag tag-green">Yes</span></span></li>
    </ul>
    <div class="pros-cons">
      <div class="pro">Full machine access for your direct commands</div>
      <div class="pro">Can use all tools: browser, cron, nodes, messaging</div>
      <div class="pro">Elevated exec bypasses sandbox (escape hatch)</div>
      <div class="neutral">Sandbox mode "all" would restrict main too</div>
      <div class="neutral">Mode "non-main" keeps main free, sandboxes others</div>
    </div>
  </div>

  <!-- Sub-Agent -->
  <div class="card card-sub">
    <div class="card-title">üü¢ Sub-Agent (Sandbox)</div>
    <span class="card-badge badge-green">ISOLATED WORKER</span>
    <div class="card-desc">Spawned sessions that run in Docker containers. Restricted tools, filesystem, and network by default.</div>
    <ul class="spec-list">
      <li><span class="spec-label">Process</span><span class="spec-value">Docker container</span></li>
      <li><span class="spec-label">Runs as</span><span class="spec-value"><span class="tag tag-green">Configurable user</span></span></li>
      <li><span class="spec-label">Sandboxed?</span><span class="spec-value"><span class="tag tag-green">Yes (when enabled)</span></span></li>
      <li><span class="spec-label">Filesystem</span><span class="spec-value"><span class="tag tag-green">Read-only root</span></span></li>
      <li><span class="spec-label">Network</span><span class="spec-value"><span class="tag tag-green">None (default)</span></span></li>
      <li><span class="spec-label">Capabilities</span><span class="spec-value"><span class="tag tag-green">ALL dropped</span></span></li>
      <li><span class="spec-label">Privilege escalation</span><span class="spec-value"><span class="tag tag-green">Blocked</span></span></li>
      <li><span class="spec-label">Custom seccomp</span><span class="spec-value"><span class="tag tag-green">Supported</span></span></li>
      <li><span class="spec-label">Custom AppArmor</span><span class="spec-value"><span class="tag tag-green">Supported</span></span></li>
      <li><span class="spec-label">Workspace access</span><span class="spec-value"><span class="tag tag-green">none / ro / rw</span></span></li>
      <li><span class="spec-label">Tool deny list</span><span class="spec-value"><span class="tag tag-green">browser, cron, nodes, channels</span></span></li>
      <li><span class="spec-label">Resource limits</span><span class="spec-value"><span class="tag tag-green">CPU, RAM, PIDs</span></span></li>
    </ul>
    <div class="pros-cons">
      <div class="pro">Fully isolated ‚Äî can't touch host filesystem</div>
      <div class="pro">No network by default (no data exfiltration)</div>
      <div class="pro">capDrop ALL + no-new-privileges</div>
      <div class="pro">Resource limits prevent runaway processes</div>
      <div class="con">Can't use browser, cron, messaging, or nodes</div>
      <div class="con">Limited tool set: exec, read, write, edit only</div>
    </div>
  </div>
</div>

<!-- Quick summary -->
<div class="flow-boxes">
  <div class="flow-box">
    <div class="flow-box-title">üèóÔ∏è Architecture Summary</div>
    <div class="flow-box-text">The Gateway is always unrestricted ‚Äî it's the orchestrator. Main session inherits gateway's power. Sub-agents can be sandboxed in Docker with full isolation. This is a <strong>two-tier trust model</strong>: you trust the main session (it's you talking), and isolate everything else.</div>
  </div>
  <div class="flow-box">
    <div class="flow-box-title">‚ö° Key Design Decision</div>
    <div class="flow-box-text">OpenClaw explicitly says: <em>"The Gateway stays on the host; tool execution runs in an isolated sandbox when enabled."</em> The gateway is NEVER sandboxed. Restricting it would cripple everything ‚Äî it needs to manage Docker, files, network, and messaging. It's the king by design.</div>
  </div>
</div>

<!-- SECTION 2: Comprehensive Dangerous Syscalls -->
<h2>2. Dangerous &amp; Kernel-Oriented Syscalls ‚Äî Full Reference</h2>

<p style="color: #8b92a8; margin-bottom: 8px;">Docker blocks 48 syscalls by default. But that's just the tip of the iceberg. Below is a comprehensive list of <strong>all security-relevant syscalls</strong> organized by threat category ‚Äî including ones Docker allows but are still dangerous, and ones that only matter for kernel-level attacks.</p>
<p style="color: #8b92a8; margin-bottom: 16px;"><span class="tag tag-blue">DOCKER</span> = blocked by Docker's default seccomp. <span class="tag tag-amber">EXTRA</span> = NOT blocked by Docker but still dangerous/kernel-oriented.</p>

<div class="syscall-section">

<!-- Category: Process & Namespace -->
<h3 style="color: #ef4444; margin-top: 28px;">üî¥ Process &amp; Namespace Control</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">clone</span><span class="syscall-desc">Create child process with new namespaces. Foundation of containers. Blocked = no fork, no exec, no Docker.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">clone3</span><span class="syscall-desc">Modern version of clone with extensible struct. Same power, same danger.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">fork</span><span class="syscall-desc">Create child process (classic). Every shell command uses this.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">vfork</span><span class="syscall-desc">Fork variant sharing parent's memory. Used by some exec implementations.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">execve</span><span class="syscall-desc">Replace process with new program. Every command execution uses this. Block = no programs can run.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">execveat</span><span class="syscall-desc">execve relative to directory fd. Used by some sandboxes.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">unshare</span><span class="syscall-desc">Create new namespaces for calling process. Block = no container creation.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setns</span><span class="syscall-desc">Join existing namespace. Block = can't exec inside Docker containers.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">pivot_root</span><span class="syscall-desc">Change root filesystem for calling process. Used in container setup.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">chroot</span><span class="syscall-desc">Change root directory. Classic jail mechanism but easily escapable.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">kill</span><span class="syscall-desc">Send signal to any process. Can terminate critical services.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">tgkill</span><span class="syscall-desc">Send signal to specific thread. Targeted process assassination.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">tkill</span><span class="syscall-desc">Legacy thread kill. Same as tgkill but less safe.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

<!-- Category: Kernel Module -->
<h3 style="color: #f59e0b; margin-top: 28px;">‚ö†Ô∏è Kernel Module &amp; Boot</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">init_module</span><span class="syscall-desc">Load kernel module from memory. Can inject rootkits directly into kernel.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">finit_module</span><span class="syscall-desc">Load kernel module from file descriptor. Same rootkit risk.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">delete_module</span><span class="syscall-desc">Unload kernel module. Can disable security modules (AppArmor, SELinux).</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">create_module</span><span class="syscall-desc">Allocate space for kernel module (obsolete). Historical rootkit vector.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">query_module</span><span class="syscall-desc">Query loaded modules. Recon for targeted module attacks.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">get_kernel_syms</span><span class="syscall-desc">Read kernel symbol table. Maps kernel memory layout for exploits.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">kexec_load</span><span class="syscall-desc">Load new kernel into memory. Can replace running kernel with malicious one.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">kexec_file_load</span><span class="syscall-desc">Same as kexec_load but from file. Kernel replacement attack vector.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">reboot</span><span class="syscall-desc">Reboot/halt/poweroff machine. Denial of service or forced kernel swap.</span><span class="syscall-impact"><span class="tag tag-amber">Useful</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
</div>

<!-- Category: Memory -->
<h3 style="color: #a855f7; margin-top: 28px;">üß† Memory Manipulation</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">process_vm_readv</span><span class="syscall-desc">Read another process's memory directly. Can steal secrets from any running process.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">process_vm_writev</span><span class="syscall-desc">Write to another process's memory. Can inject code into running processes.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">ptrace</span><span class="syscall-desc">Full process debugging/tracing. Read memory, inject syscalls, hijack execution. The Swiss Army knife of attacks.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">mbind</span><span class="syscall-desc">Bind memory to NUMA node. Can manipulate kernel memory allocation patterns.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">set_mempolicy</span><span class="syscall-desc">Set NUMA memory allocation policy for process.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">get_mempolicy</span><span class="syscall-desc">Read NUMA memory policy. Information disclosure.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">move_pages</span><span class="syscall-desc">Move pages between NUMA nodes. Can cause side-channel leaks.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">userfaultfd</span><span class="syscall-desc">Handle page faults in userspace. Used in kernel exploits to win race conditions.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">mmap</span><span class="syscall-desc">Map files/devices into memory. Core syscall ‚Äî blocking kills everything, but can map /dev/mem for kernel access.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">mprotect</span><span class="syscall-desc">Change memory protection. Make data executable ‚Äî key step in shellcode injection.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">mremap</span><span class="syscall-desc">Remap memory region. Can be abused in heap exploitation.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">mincore</span><span class="syscall-desc">Check which pages are in RAM. Side-channel attack vector (page cache timing).</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

<!-- Category: Filesystem -->
<h3 style="color: #10b981; margin-top: 28px;">üìÅ Filesystem &amp; Mount</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">mount</span><span class="syscall-desc">Mount filesystem. Can overlay /etc, /bin with attacker-controlled content.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">umount</span><span class="syscall-desc">Unmount filesystem. Can unmount /proc, /sys to blind security tools.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">umount2</span><span class="syscall-desc">Unmount with flags (lazy, force). Same risk as umount.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">swapon</span><span class="syscall-desc">Enable swap on file/device. Can create swap on sensitive file to extract data after reboot.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">swapoff</span><span class="syscall-desc">Disable swap. Forces all pages into RAM ‚Äî can trigger OOM killer.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">open_by_handle_at</span><span class="syscall-desc">Open file by kernel handle. Famous Docker container escape (CVE-2015-3456).</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">fsconfig</span><span class="syscall-desc">Configure filesystem (new mount API). Fine-grained mount parameter control.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">fsmount</span><span class="syscall-desc">Create mount from superblock (new mount API). Modern mount attack surface.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">fsopen</span><span class="syscall-desc">Open filesystem context (new mount API). First step in new mount sequence.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">fspick</span><span class="syscall-desc">Pick existing mount for reconfiguration. Can modify mounted filesystem options.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">move_mount</span><span class="syscall-desc">Move mount between locations. Part of new mount API.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">open_tree</span><span class="syscall-desc">Open/clone mount tree. Can duplicate mount hierarchy for manipulation.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

<!-- Category: I/O & Hardware -->
<h3 style="color: #ec4899; margin-top: 28px;">üîß I/O, Hardware &amp; Devices</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">ioperm</span><span class="syscall-desc">Set I/O port permissions. Direct hardware access ‚Äî can talk to disk controllers, NICs.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">iopl</span><span class="syscall-desc">Set I/O privilege level for entire process. Ring-0 equivalent for port I/O.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">ioctl</span><span class="syscall-desc">Device-specific control. Huge attack surface ‚Äî every driver has its own ioctl commands. Can't block without breaking everything.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">ioprio_set</span><span class="syscall-desc">Set I/O scheduling priority. Can starve other processes of disk access.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">personality</span><span class="syscall-desc">Set process execution domain (BSD/SVR4 emulation). Poorly tested kernel paths = vulnerability surface.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">vm86</span><span class="syscall-desc">Enter x86 real-mode virtual machine. Legacy ‚Äî kernel code rarely tested, exploit goldmine.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
</div>

<!-- Category: BPF & Tracing -->
<h3 style="color: #f97316; margin-top: 28px;">üîç BPF, Tracing &amp; Profiling</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">bpf</span><span class="syscall-desc">Load eBPF programs into kernel. Kernel-level programmable hooks ‚Äî can intercept any syscall, packet, or event.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">perf_event_open</span><span class="syscall-desc">Performance monitoring. Can monitor any process's cache misses, branches ‚Äî side-channel goldmine.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">lookup_dcookie</span><span class="syscall-desc">Profiling helper ‚Äî resolves kernel dentry cookies. Leaks filesystem layout info.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">kcmp</span><span class="syscall-desc">Compare kernel objects between processes. Can fingerprint shared resources for targeted attacks.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
</div>

<!-- Category: Time -->
<h3 style="color: #06b6d4; margin-top: 28px;">‚è∞ Time Manipulation</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">clock_settime</span><span class="syscall-desc">Set system clock. Can break TLS cert validation, cron schedules, log timestamps, auth tokens.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">clock_adjtime</span><span class="syscall-desc">Gradually adjust clock. Subtler time manipulation ‚Äî harder to detect.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">settimeofday</span><span class="syscall-desc">Legacy time setter. Same risks as clock_settime.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">adjtimex</span><span class="syscall-desc">Tune kernel clock discipline. Fine-grained clock manipulation. NOT blocked by Docker.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

<!-- Category: Credentials & Capabilities -->
<h3 style="color: #8b5cf6; margin-top: 28px;">üîë Credentials, Capabilities &amp; Keyring</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">capset</span><span class="syscall-desc">Set process capabilities. Can grant itself CAP_SYS_ADMIN (effectively root).</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">capget</span><span class="syscall-desc">Get process capabilities. Recon ‚Äî discover what powers a process has.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setuid</span><span class="syscall-desc">Change user ID. Privilege escalation ‚Äî become root from non-root.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setgid</span><span class="syscall-desc">Change group ID. Gain access to group-restricted resources.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setreuid</span><span class="syscall-desc">Set real and effective UID. More flexible privilege change.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setresuid</span><span class="syscall-desc">Set real, effective, and saved UID. Complete identity swap.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">add_key</span><span class="syscall-desc">Add key to kernel keyring. Not namespace-isolated ‚Äî leaks across containers.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">keyctl</span><span class="syscall-desc">Manage kernel keyring. Read/modify/destroy keys from other processes.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">request_key</span><span class="syscall-desc">Request key from keyring. Can access keys from other sessions.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">prctl</span><span class="syscall-desc">Process attribute control. Can disable ASLR, set dumpable, change securebits. NOT blocked by Docker.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">seccomp</span><span class="syscall-desc">Install seccomp filter on self. A process can restrict its own syscalls ‚Äî but also bypass existing filters in some edge cases.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

<!-- Category: Network -->
<h3 style="color: #14b8a6; margin-top: 28px;">üåê Network &amp; Sockets</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">socket</span><span class="syscall-desc">Create network socket. Foundation of all networking. Can create raw sockets for packet sniffing/injection.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">bind</span><span class="syscall-desc">Bind socket to address. Can hijack ports from other services.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">connect</span><span class="syscall-desc">Connect to remote host. Data exfiltration, C2 communication, SSRF.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">sendmsg</span><span class="syscall-desc">Send message on socket. Can pass file descriptors between processes (SCM_RIGHTS).</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">recvmsg</span><span class="syscall-desc">Receive message from socket. Can receive passed file descriptors.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setsockopt</span><span class="syscall-desc">Set socket options. BPF_ATTACH, SO_REUSEPORT, raw socket options ‚Äî huge attack surface.</span><span class="syscall-impact"><span class="tag tag-red">BREAKS</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">nfsservctl</span><span class="syscall-desc">Control NFS daemon. Network filesystem manipulation (obsolete).</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
</div>

<!-- Category: Accounting & Resources -->
<h3 style="color: #64748b; margin-top: 28px;">üìä Accounting, Quotas &amp; Resources</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">acct</span><span class="syscall-desc">Enable/disable process accounting. Can disable resource tracking to hide activity.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">quotactl</span><span class="syscall-desc">Manage disk quotas. Can remove limits to fill disk or set zero quota to DoS users.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setrlimit</span><span class="syscall-desc">Set resource limits. Can raise limits to bypass cgroup restrictions. NOT blocked by Docker.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">prlimit64</span><span class="syscall-desc">Get/set resource limits for any process. Can raise OTHER processes' limits. NOT blocked by Docker.</span><span class="syscall-impact"><span class="tag tag-amber">Maybe</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">sched_setaffinity</span><span class="syscall-desc">Pin process to specific CPUs. Can create side-channel conditions or starve other processes.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">sched_setscheduler</span><span class="syscall-desc">Change scheduling policy. Set SCHED_FIFO to monopolize CPU.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">setpriority</span><span class="syscall-desc">Set process priority (nice). Can set -20 (highest priority) to starve everything else.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

<!-- Category: Obsolete but haunted -->
<h3 style="color: #6b7280; margin-top: 28px;">üëª Obsolete but Haunted</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's dangerous</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">uselib</span><span class="syscall-desc">Load shared library (unused since glibc 2.0). Legacy code path = unaudited = exploit target.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">ustat</span><span class="syscall-desc">Legacy filesystem statistics. Replaced by statfs. Dead code in kernel.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">sysfs</span><span class="syscall-desc">Legacy filesystem type enumeration. Obsolete since procfs.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">_sysctl</span><span class="syscall-desc">Legacy kernel parameter access. Removed in kernel 5.5. Replaced by /proc/sys.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">stime</span><span class="syscall-desc">Legacy set time (32-bit). Superseded by clock_settime.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
  <div class="syscall-row"><span class="syscall-name">vm86</span><span class="syscall-desc">x86 real-mode VM (16-bit DOS emulation). Barely maintained kernel code.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-blue">DOCKER</span></span></div>
</div>

<!-- Category: Landlock (modern) -->
<h3 style="color: #22d3ee; margin-top: 28px;">üè∞ Landlock (Modern Sandboxing)</h3>
<div class="syscall-grid">
  <div class="syscall-header"><span>Syscall</span><span>What it does &amp; why it's interesting</span><span>Gateway Impact</span><span>Source</span></div>
  <div class="syscall-row"><span class="syscall-name">landlock_create_ruleset</span><span class="syscall-desc">Create Landlock sandbox ruleset. Unprivileged sandboxing ‚Äî any process can restrict ITSELF. Kernel 5.13+.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">landlock_add_rule</span><span class="syscall-desc">Add filesystem/network rule to Landlock ruleset. Fine-grained path restrictions.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
  <div class="syscall-row"><span class="syscall-name">landlock_restrict_self</span><span class="syscall-desc">Apply Landlock ruleset to current process. Irreversible self-sandboxing.</span><span class="syscall-impact"><span class="tag tag-gray">None</span></span><span class="syscall-impact"><span class="tag tag-amber">EXTRA</span></span></div>
</div>

</div>

<!-- Impact summary -->
<h3>Impact Summary ‚Äî 80+ Dangerous Syscalls</h3>
<div class="flow-boxes">
  <div class="flow-box" style="border-color: #ef4444;">
    <div class="flow-box-title" style="color: #fca5a5;">üî¥ Would BREAK OpenClaw (14 syscalls)</div>
    <div class="flow-box-text">
      <strong>clone/clone3/fork/vfork</strong> ‚Äî Every shell command needs process creation.<br>
      <strong>execve/execveat</strong> ‚Äî Every program execution. Block = nothing runs.<br>
      <strong>setns/unshare</strong> ‚Äî Docker container management.<br>
      <strong>socket/bind/connect/sendmsg/recvmsg</strong> ‚Äî All network communication.<br>
      <strong>ioctl</strong> ‚Äî Terminal control, device communication. Used by everything.<br>
      <strong>mmap/mprotect</strong> ‚Äî Memory allocation. Node.js V8 engine needs these to run at all.
    </div>
  </div>
  <div class="flow-box" style="border-color: #f59e0b;">
    <div class="flow-box-title" style="color: #fcd34d;">üü° Could Restrict But Risky (12 syscalls)</div>
    <div class="flow-box-text">
      <strong>mount, ptrace, reboot</strong> ‚Äî Docker already blocks these. Safe to block on gateway too, but it can also just use shell commands to mount/reboot anyway.<br>
      <strong>capset, setuid, setgid, setreuid, setresuid</strong> ‚Äî Privilege changes. Gateway already runs as root, so moot.<br>
      <strong>prctl, setrlimit, prlimit64, mremap, kill/tgkill</strong> ‚Äî Potentially useful to restrict, but hard to predict all legitimate uses.
    </div>
  </div>
</div>
<div class="flow-box" style="border-color: #10b981; margin-bottom: 20px;">
  <div class="flow-box-title" style="color: #6ee7b7;">üü¢ Safe to Block but Irrelevant (50+ syscalls)</div>
  <div class="flow-box-text">
    Kernel modules, NUMA manipulation, x86 real-mode, I/O port access, keyring, profiling, BPF loading, time setting, NFS, quotas, obsolete calls. Node.js never touches any of these. Docker blocks most of them already. Blocking them on bare metal would be security theater ‚Äî the gateway has <code>exec</code> and can just run shell commands to achieve the same effects through userspace tools.
  </div>
</div>

<!-- VERDICT -->
<div class="verdict">
  <div class="verdict-title">ü¶û The Verdict</div>
  <div class="verdict-text">
    <strong>Don't restrict the gateway. It's the king by design.</strong><br><br>
    Out of 80+ dangerous syscalls across all categories, <strong>14 would completely break OpenClaw</strong> if blocked (process creation, exec, networking, memory, Docker management). Another 12 could theoretically be restricted but the gateway can achieve the same effects through shell commands anyway. The remaining 50+ are irrelevant to a Node.js process.<br><br>
    OpenClaw's security model is <strong>two-tiered</strong>: the gateway runs unrestricted on the host (it's YOUR agent, YOUR machine), while sub-agents run in hardened Docker containers (capDrop ALL, no network, read-only root, no-new-privileges).<br><br>
    <strong>Where your real defenses are:</strong>
    <ul style="margin: 12px 0 0 20px; list-style: disc;">
      <li>UFW firewall (default deny, explicit allowlist)</li>
      <li>GeoIP blocking on SSH (Israel + Europe only)</li>
      <li>Fail2ban (3 strikes = ban + notification)</li>
      <li>SSH hardened (key-only, non-standard port, hardened crypto)</li>
      <li>WhatsApp DM pairing (only authorized numbers)</li>
      <li>User isolation (non-root users can't touch secrets)</li>
      <li>AIDE + rkhunter + chkrootkit (daily integrity scans)</li>
      <li>psad (port scan auto-blocking)</li>
    </ul>
    <br>
    <strong>Section 4 recommendation: Skip entirely.</strong> OpenClaw already sandboxes what needs sandboxing (sub-agents). The gateway needs full power. Restricting it is like giving a surgeon gloves and then tying their hands.
  </div>
</div>

</div>
</body>
</html>
